{"files":[{"id":"e20acf39-ee53-409c-9fec-65f585a964c9","name":"appsscript","type":"json","source":"{\n  \"timeZone\": \"America/Sao_Paulo\",\n  \"dependencies\": {\n  },\n  \"webapp\": {\n    \"access\": \"ANYONE\",\n    \"executeAs\": \"USER_ACCESSING\"\n  },\n  \"exceptionLogging\": \"STACKDRIVER\",\n  \"runtimeVersion\": \"V8\"\n}"},{"id":"a12ce547-5c74-41bd-8d61-58263fc814df","name":"Código","type":"server_js","source":"function doGet() {\n  \n  var temp \u003d HtmlService.createTemplateFromFile(\"Principal\");\n  \n  return temp.evaluate();\n  \n}\n"},{"id":"8e9a852e-2cfc-41c5-b9da-24f2917531cb","name":"Login","type":"server_js","source":"\nvar url \u003d \"https://docs.google.com/spreadsheets/d/1MnHtX7zhewlW8S0kb25Y9BGquxKX_sI8wLjV6vUzBCo/edit#gid\u003d0\"\n\nfunction ConfirmarLogin(Login) {\n \n  var Planilha \u003d SpreadsheetApp.openByUrl(url);\n  var Guia \u003d Planilha.getSheetByName(\"Login\");  \n  var LocalPesquisa \u003d Guia.getRange(4, 2, Guia.getLastRow()).getValues();\n  \n  var Resultado \u003d LocalPesquisa.Pesquisa(Login.Usuario)\n  \n  var Linha \u003d Resultado + 4\n  \n  if ([Login.Usuario] \u003d\u003d \"Clebs\"){\n    \n        if ([Login.Senha] \u003d\u003d \"c2022\"){\n            \n            if (Resultado !\u003d -1){\n              \n              Guia.getRange(Linha, 3).setValue(\"LOGADO\");\n              Guia.getRange(2, 6).setValue(Login.Usuario);\n              \n              var Data \u003d new Date();\n              Guia.getRange(4, 6).setValue(Data);\n              Guia.getRange(\u0027F4\u0027).activate();\n              Guia.getActiveRangeList().setNumberFormat(\u0027@\u0027);\n              Guia.getActiveRangeList().setNumberFormat(\u0027#,##0.00\u0027);\n              \n              var Retorno \u003d \"OK\";\n              return Retorno;\n            }\n  \n        }\n   \n  }\n  \n  //Wellington User\n    if ([Login.Usuario] \u003d\u003d \"Wellington\"){\n    \n        if ([Login.Senha] \u003d\u003d \"w2022\"){\n            \n            if (Resultado !\u003d -1){\n              \n              Guia.getRange(Linha, 3).setValue(\"LOGADO\");\n              Guia.getRange(2, 6).setValue(Login.Usuario);\n              \n              var Data \u003d new Date();\n              Guia.getRange(4, 6).setValue(Data);\n              Guia.getRange(\u0027F4\u0027).activate();\n              Guia.getActiveRangeList().setNumberFormat(\u0027@\u0027);\n              Guia.getActiveRangeList().setNumberFormat(\u0027#,##0.00\u0027);\n              \n              var Retorno \u003d \"OK\";\n              return Retorno;\n            }\n  \n        }\n   \n  }\n  \n   //Otavio User\n    if ([Login.Usuario] \u003d\u003d \"Otavio\"){\n    \n        if ([Login.Senha] \u003d\u003d \"o2022\"){\n            \n            if (Resultado !\u003d -1){\n              \n              Guia.getRange(Linha, 3).setValue(\"LOGADO\");\n              Guia.getRange(2, 6).setValue(Login.Usuario);\n              \n              var Data \u003d new Date();\n              Guia.getRange(4, 6).setValue(Data);\n              Guia.getRange(\u0027F4\u0027).activate();\n              Guia.getActiveRangeList().setNumberFormat(\u0027@\u0027);\n              Guia.getActiveRangeList().setNumberFormat(\u0027#,##0.00\u0027);\n              \n              var Retorno \u003d \"OK\";\n              return Retorno;\n            }\n  \n        }\n   \n  }\n \n  //Gustavo User\n    if ([Login.Usuario] \u003d\u003d \"Gustavo\"){\n    \n        if ([Login.Senha] \u003d\u003d \"g2022\"){\n            \n            if (Resultado !\u003d -1){\n              \n              Guia.getRange(Linha, 3).setValue(\"LOGADO\");\n              Guia.getRange(2, 6).setValue(Login.Usuario);\n              \n              var Data \u003d new Date();\n              Guia.getRange(4, 6).setValue(Data);\n              Guia.getRange(\u0027F4\u0027).activate();\n              Guia.getActiveRangeList().setNumberFormat(\u0027@\u0027);\n              Guia.getActiveRangeList().setNumberFormat(\u0027#,##0.00\u0027);\n              \n              var Retorno \u003d \"OK\";\n              return Retorno;\n            }\n  \n        }\n   \n  }\n \n  \n  \n  \n  //termina\n  \n  \n  \n}\n\n\n\nArray.prototype.Pesquisa \u003d function(Procura){\n\nif (Procura \u003d\u003d \"\") return false;\n  \n  for (var Linha \u003d 0; Linha\u003cthis.length; Linha ++)\n    \n    if (this[Linha] \u003d\u003d Procura) return Linha;\n  \n  return -1\n}\n\n\n\nfunction Limpar(){\n\nvar Planilha \u003d SpreadsheetApp.openByUrl(url);\nvar Guia \u003d Planilha.getSheetByName(\"Login\");\n\nvar DataAtual \u003d Guia.getRange(3, 6).getValue();\nvar UltimoLogin \u003d  Guia.getRange(4, 6).getValue();\n  \n  if (DataAtual !\u003d UltimoLogin ){\n  \n    Guia.getRange(\u0027C4:C50\u0027).activate();\n    Guia.getActiveRangeList().clear({contentsOnly: true, skipFilteredRows: true});\n    \n    Guia.getRange(2, 6).setValue(\"\");\n    \n    \n  }\n  \n  \n  \n\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"},{"id":"d09e44ea-ca1e-4285-a42a-9aeb54d9c0b5","name":"Principal","type":"html","source":"\u003c!DOCTYPE html\u003e\n\u003chtml\u003e\n  \u003chead\u003e\n    \u003cbase target\u003d\"_top\"\u003e\n    \n    \n    \u003cstyle\u003e\n    \n    \n    body{\n    background-image:url(\"https://www.belasis.com.br/wp-content/uploads/2018/03/Novidades-Barbearia-Blogpost-Belasis-.png\");\n  background-size: cover;\n    \n    }\n    \n    #AreaLogin{\n    \n     background-color: #1992b7;\n     width: 380px;\n     height: 260px;\n     margin: 140px auto 0px;\n     border-radius: 5px;\n     \n    }\n    \n    #AreaInterna{\n    \n     background-color: #fdfdfd;\n     width: 360px;\n     height: 240px;\n     position: absolute;\n     margin: 10px;\n     border-radius: 5px;\n     box-shadow: 0px 0px 5px black;\n     \n    }\n    \n    \n    #Cabecalho{\n    \n     background-color: green;\n     height: 45px;\n     text-align: center;\n     font: bold 14px/45px sans-serif; \n     border-top-left-radius: 5px; \n     border-top-right-radius: 5px;\n     border-bottom: 1px solid #bfc3c5;\n     box-shadow: 1px 0px 3px black #dedede;\n     \n    }\n    \n    #labeluser{\n    \n    position: absolute;\n    top: 70px;\n    left: 20px;\n    \n    }\n    \n    #user{\n    \n     position: absolute;\n     top: 70px;\n     left: 75px;\n     width: 250px;\n     \n    }\n    \n    #labelsenha{\n    \n    position: absolute;\n    top: 110px;\n    left: 20px;\n    \n    }\n   \n   #senha{\n   \n     position: absolute;\n     top: 110px;\n     left: 75px;\n     width: 250px;\n   \n   }\n    \n    #botao{\n    \n     position: absolute;\n     top: 170px;\n     left: 150px;\n     background-color: red;\n     padding: 5px 15px;\n     font: bold 12px sans-serif; \n     border-radius: 25px;\n     border: 1px solid #9eb9c3;\n     \n    }\n    \n    #botao:hover{\n    cursor: pointer;\n    background-color: yellow;\n    }\n    \n    #btn2{\n    \n     position: absolute;\n     top: 170px;\n     left: 260px;\n     display: none;\n    }\n    \n    \n    \n    \u003c/style\u003e\n    \n    \n  \u003c/head\u003e\n  \u003cbody\u003e\n    \n     \u003cdiv id \u003d \"AreaLogin\"\u003e\n     \n          \u003cdiv id\u003d \"AreaInterna\"\u003e\n               \n               \u003cdiv id \u003d \"Cabecalho\"\u003eLOGIN\u003c/div\u003e\n                \n                \u003clabel id \u003d\"labeluser\"\u003eUsuário\u003c/label\u003e\n                \u003cinput type\u003d\"text\" id \u003d \"user\" style \u003d \"text-align: center;\"\u003e\n                \n                \u003clabel id \u003d\"labelsenha\"\u003eSenha\u003c/label\u003e\n                \u003cinput type\u003d\"password\" id \u003d \"senha\" style \u003d \"text-align: center;\"\u003e\n                \n                 \u003cbutton id \u003d \"botao\"\u003eENTRAR\u003c/button\u003e \n                 \n                 \u003ca href \u003d\"https://script.google.com/macros/s/AKfycbyYVkwPu0qEwVcNX6_aqTEN8UwOSHut9DNyKjHS_VQH1EaqBMo1/exec\"\u003e\n                 \u003cbutton id \u003d \"btn2\" disabled \u003d \"true\"\u003eENTRAR\u003c/button\u003e \n                 \u003c/a\u003e\n                 \n         \u003c/div\u003e\n         \n     \u003c/div\u003e\n    \n    \n    \u003cscript type \u003d \"text/javascript\"\u003e\n    \n  \n  document.addEventListener(\"DOMContentLoaded\", LimparLogados);\n  \n  function LimparLogados(){\n  \n  google.script.run.withSuccessHandler().Limpar();\n    \n  \n  }\n  \n  \n    \n    document.getElementById(\"botao\").addEventListener(\"click\", Login);\n        \n    function Login(){\n    \n      \n    var Usuario \u003d document.getElementById(\"user\").value;   \n    var Senha \u003d document.getElementById(\"senha\").value;\n     \n    \n    \n    var Login \u003d{    \n    Usuario: Usuario,\n    Senha: Senha,    \n    };\n    \n\n    \n    google.script.run.withSuccessHandler(Ver).ConfirmarLogin(Login);\n   \n    \n    function Ver(Retorno){\n    \n    if (Retorno \u003d\u003d \"OK\"){\n    \n    document.getElementById(\"btn2\").disabled \u003d false;\n    document.getElementById(\"btn2\").click();\n    \n    }else{\n    \n    alert (\"Usuário ou Senha incorreto!\");\n    return false;\n    }\n    \n    }\n    \n }\n      \n    \u003c/script\u003e\n    \n    \n  \u003c/body\u003e\n  \n  \n  \n\u003c/html\u003e\n\n\n\n\n\n\n\n\n\n"}]}